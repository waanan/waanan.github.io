---
title: "继承和访问说明符"
date: 2024-10-08T17:45:57+08:00
---

在本章前面的课程中，您已经了解了一些关于基继承如何工作的知识。在迄今为止的所有示例中，我们都使用了公共继承。也就是说，我们的派生类公开继承基类。在本课中，我们将更仔细地看一看公共继承，以及其他两种类型的继承（私有继承和受保护继承）。我们还将探索不同类型的继承如何与访问说明符交互，以允许或限制对成员的访问。至此，您已经看到了私有和公共访问说明符，它们决定了谁可以访问类的成员。作为一个快速刷新程序，任何人都可以访问公共成员。私有成员只能由同一类或朋友的成员函数访问。这意味着派生类不能直接访问基类的私有成员！基类{private:int m_private{}；//只能由基成员和朋友（不是派生类）public:int m_public{}；//任何人都可以访问}；这非常简单，您现在应该已经很习惯了。受保护的访问说明符在处理继承的类时，事情变得有点复杂。C++有第三个访问说明符，我们还没有谈到，因为它只在继承上下文中有用。受保护的访问说明符允许成员所属的类、朋友类和派生类访问该成员。然而，不能从类外部访问受保护的成员。类Base{public:int m_public{}；//任何受保护的人都可以访问：int m_protected{}；//可以由基成员、朋友和派生类private:int m_private{}；//只能由基成员和朋友访问（但不能由派生类访问）}；派生的类：public Base{public:Derived（）{m_public=1；//允许：可以从派生类m_protected=2访问公共基成员；//allowed:可以从派生类别m_private=3访问受保护的基成员；//不允许：不能从派生类}}访问私有基成员；int main（）{Base Base；Base.m_public=1；//allowed:可以从外部类Base.m_protected=2；//不允许：不能从外部类Base.m_private=3；//禁止：不能从外面的类访问私有成员return 0；}在上面的示例中，可以看到受保护的基成员m_protective可由派生类直接访问，但不能由公共访问。那么，我应该何时使用受保护的访问说明符？在基类中具有受保护的属性时，派生类可以直接访问该成员。这意味着，如果以后更改有关受保护属性的任何内容（类型、值的含义等），则可能需要同时更改基类和所有派生类。因此，当您（或您的团队）要从自己的类中派生时，使用受保护的访问说明符是最有用的，并且派生类的数量是合理的。这样，如果您对基类的实现进行了更改，并且因此需要更新派生类，则可以自己进行更新（并且不要永远更新，因为派生类的数量是有限的）。使成员私有意味着公共类和派生类不能直接更改基类。这有助于将公共类或派生类与实现更改隔离开来，并确保正确维护不变量。然而，这也意味着您的类可能需要更大的公共（或受保护）接口来支持公共或派生类操作所需的所有函数，这有其自己的构建、测试和维护成本。通常，如果可以，最好将成员设为私有的，并且仅在计划派生类且构建和维护与这些私有成员的接口的成本太高时使用受保护的。最佳实践支持私人成员，而不是受保护的成员。不同类型的继承及其对访问的影响首先，类有三种不同的方式从其他类继承：public、protected和private。为此，只需指定选择要从中继承的类时所需的访问类型：//从基类继承公共类Pub:public Base{}；//从Base protectedly类Pro:protected Base{}继承；//从基类私有继承Pri:private Base{}；类Def:Base//默认为私有继承{}；如果不选择继承类型，C++默认为私有继承（就像如果不另行指定，则成员默认为私有访问一样）。这为我们提供了9种组合：3个成员访问说明符（public、private和protected），以及3个继承类型（public，private，and protected.）。那么这两者之间的区别是什么？简而言之，当继承成员时，继承成员的访问说明符可以更改（仅在派生类中），具体取决于使用的继承类型。换句话说，在基类中是公共的或受保护的成员可以更改派生类中的访问说明符。这似乎有点令人困惑，但并没有那么糟糕。我们将在本课的其余部分详细探讨这一点。在单步执行示例时，请记住以下规则：类始终可以访问其自己的（非继承的）成员。公共基于它正在访问的类的访问说明符来访问类的成员。派生类基于从父类继承的访问说明符访问继承的成员。这取决于访问说明符和使用的继承类型。公共继承公共继承是迄今为止最常用的继承类型。事实上，您很少会看到或使用其他类型的继承，因此您的主要关注点应该是理解这一部分。幸运的是，公共继承也是最容易理解的。当您公开继承基类时，继承的公共成员保持公开，而继承的受保护成员保持受保护。继承的私有成员保持不可访问，因为它们在基类中是私有的。基类中的访问说明符继承publicPublicProtectedProtectedPrivateInaccessible时访问说明词下面是一个演示如何工作的示例：类base{public:intm_public{}；受保护：int m_protected{}；私有：int m_private{}；}；类Pub:public Base//注意：public inheritation{//公共继承意味着：//公共继承成员保持公共（因此m_public被视为公共）//受保护的继承成员保持受保护（因此m_Protected被视为由受保护）//私有继承成员保持不可访问（因此m.Private不可访问）public:Pub（）{m_public=1；//okay:m_Publica被继承为public m_Protected=2；//oky:m_producted被继承为由受保护的m_Private=3；//not okay:m_Private无法从派生类}}访问；int main（）{//外部访问使用被访问类的访问说明符。Base Base；Base.m_public=1；//okay:m_public在Base.m_protected=2；//不正常：m_protective在Base.m_private=3中受保护；//不好：m_private在Base-Pub Pub Pub中是私有的；Pub.m_publica=1；//好：m_publica在Pub Pub.m_protected=2中是公共的；//不正确：m_Protectived在Pub Pub.m_private=3中受保护与上面的例子相同，我们引入了受保护的访问说明符，只是我们也实例化了派生类，只是为了说明使用公共继承，在基类和派生类中的工作是相同的。公共继承是您应该使用的，除非您有特定的理由不这样做。最佳实践使用公共继承，除非您另有特定的理由。保护继承保护继承是最不常用的继承方法。它几乎从未使用过，除非在非常特殊的情况下。通过受保护的继承，公共成员和受保护成员将受到保护，私有成员将无法访问。由于这种形式的继承非常罕见，因此我们将跳过该示例，并仅用一个表进行总结：基类中的Access说明符继承时访问说明符protectedlyPublicProtectedProtectedPrivateInaccessiblePrivate继承通过私有继承，基类的所有成员都作为私有继承。这意味着私有成员不可访问，受保护成员和公共成员变为私有成员。请注意，这不会影响派生类访问从其父类继承的成员的方式！它只影响试图通过派生类访问这些成员的代码。class Base{public:int m_public{}；受保护：int m_protected{}；私有：int m_private{}；}；类Pri:private Base//注意：private inheritation{//私有继承意味着：//公共继承的成员变为私有（因此m_Public被视为私有）//受保护的继承成员变为专用（因此m_Protected被视为由私有）//私有继承的成员保持不可访问（因此m.private不可访问）Public:Pri（）{m_Public=1；//okay:m_publical现在在Pri m_Protected=2中是私有的；//okay:m_producted现在在Pri m_private=3中是专用的；//不正常：派生类不能访问基类}中的私有成员；int main（）{//外部访问使用被访问类的访问说明符。//在这种情况下，base.base base；base.m_public=1；//okay:m_public在base.m_protected=2；//不正常：m_protectived在base.m_private=3中受保护；//不好：m_private在base Pri中为私有；Pri.m_publica=1；//不行：m_public现在在Pri中是私有的。mprotected=2；//不oky:m_Protective现在在Pri.m_private=2中是专用的。//不好：m_private在Pri中不可访问返回0；}以表格形式总结：基类中的访问说明符继承privatelPublicPrivateProtectedPrivatePrivateInaccessiblePrivate时访问说明器当派生类与基类没有明显的关系，但在内部使用基类实现时，private继承可能很有用。在这种情况下，我们可能不希望基类的公共接口通过派生类的对象公开（就像我们公开继承的那样）。在实践中，很少使用私有继承。最后一个示例类Base{public:intm_public{}；受保护：int m_protected{}；私有：int m_private{}；}；Base可以无限制地访问其自己的成员。public只能访问m_public。派生类可以访问m_public和m_protected.class D2:private Base//注意：private inheritation{//私有继承意味着：//公共继承的成员成为私有的//受保护的继承的成员变成私有的//私有继承的成员保持不可访问的public:int m_public2{}；受保护：int m_protected2{}；私有：int m_private2{}；}；D2可以无限制地访问其自己的成员。D2可以访问Base的m_public和m_protected成员，但不能访问m_private。由于D2私有继承了Base，因此当通过D2访问时，m_public和m_protected现在被认为是私有的。这意味着当使用D2对象时，公共不能访问这些变量，也不能访问从D2派生的任何类。类D3:public D2{//公共继承意味着：//公共继承成员保持公共//受保护的继承成员保持受保护//私有继承成员保持不可访问public:int m_public3{}；受保护：int m_protected3{}；私有：int m_private3{}；}；D3可以无限制地访问自己的成员。D3可以访问D2的m_public2和m_protected2成员，但不能访问m_private2。由于D3公开继承了D2，因此当通过D3访问时，m_public2和m_protected2保留其访问说明符。D3无法访问Base的m_private，它在Base中已经是私有的。它也没有访问Base的m_protected或m_public的权限，当D2继承它们时，它们都成为私有的。摘要访问说明符、继承类型和派生类的交互方式导致了许多混淆。尽可能地尝试和澄清事情：首先，类（和朋友）总是可以访问其自己的非继承成员。访问说明符仅影响外部人员和派生类是否可以访问这些成员。其次，当派生类继承成员时，这些成员可以更改派生类中的访问说明符。这不会影响派生类自己的（非继承的）成员（它们有自己的访问说明符）。它仅影响外部人员和从派生类派生的类是否可以访问这些继承成员。下面是所有访问说明符和继承类型组合的表：基类中的访问说明词继承时为publiclyAccess说明符继承时为privatelAccess说明文继承时为protectedlyPublicPublicPrivateProtectedProtectedPrivateInaccessibleInaccessableInaccessableInaccess作为最后一点，尽管在上面的示例中，我们只显示了使用成员变量的示例，但这些访问规则对所有成员（例如，在类中声明的成员函数和类型）都有效。Next lesson24.6将新功能添加到派生类返回到内容表Previous lesson24.4派生类的构造函数和初始化

